<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.0.xsd">

  <changeSet id="2023-09-29--12-00-create-events-shared-instances-table" author="VolodymyrRohach">
    <createTable tableName="events_shared_instances">
      <column name="event_id" type="uuid">
        <constraints primaryKey="true" nullable="false"/>
      </column>
      <column name="created_date" type="timestamptz"/>
    </createTable>
    <createProcedure>
      create function ${database.defaultSchemaName}.insert_events_set_created_date() returns trigger
        language plpgsql
      as
      $$
      BEGIN
          NEW.created_date := current_timestamp;
      RETURN NEW;
      END;
      $$;
    </createProcedure>
  </changeSet>

</databaseChangeLog>
